http://spring.io

1. Spring 개발 2가지 방법

  가. Spring Framework
     
      -XML 만 이용
      -XML + 어노테이션(@, 자바) : 최소한의 xml 필요
      -어노테이션(자바) : java Configuration

   ==> 개발자가 명시적으로 의존성 설정, 빈 등록, 의존성 주입, 서버설정 등 다양한 작업을 지정.

  나. SpringBoot
      - auto configuration
      - Spring Framework 어노테이션(자바) 기반


2. 빌드 툴(build tool)

  가. 개발 프로세스

  주문 --> 분석 --> 설계 ---> 구현 --->테스트 --> 패키지 ---> 배포

  나. 빌드 툴 
    - 개발 프로세스 자동화
    - 필요한 의존성 다운로드 설정기능
    - 자동으로 컴파일
    - 자동으로 테스트 ( 단위테스트 )
    - 자동으로 패키지 (압축, jar, war )
    - 자동으로 배포

  다. 종류
     - maven
        pom.xml 설정파일

     - gradle
        build.gradle 설정파일


3. Spring 특징

  가. POJO 기반
   - POJO ( Plain Old Java Object )
   - 클래스 작성시 어떠한 interface 또는 class 상속/구현하지 않음.

  나. 클래스
   - 빈(bean) 이라고 부름.
   - 직접 new 하지 않는다. ==> 외부에서 처리한다.
     a. 빈을 xml에 등록
         <bean id="" class="빈" />
     b. ApplicationContext에 xml 설정
       -ApplicationContext가 xml 정보를 보고 빈을 생성한다.

     c. 빈 사용
        - getBean("id값", 빈.class );


  다. 제어의 역행 ( Inversion of Control : IoC )
    - 빈을 생성 및 의존성 설정 작업을 직접하지 않고
      외부에서 처리하는 개념.
    - ApplicationContext가 IoC Container라고 한다.


  라. IoC Container 계층 구조

        BeanFactory   MessageSource
	     |          |  
	ApplicationContext ( 인터페이스 )
             |  
             |       
          WebApplicationContext(*, 웹환경)		
	  GenericXmlApplicationContext(*)
	  ClassPathXmlApplicationContext
	    ...


   마. 의존성 주입 ( dependency Injection : DI )
     - 외부에서 빈을 설정하는 개념

     a. 생성자 이용
        <bean>
	  <constructor-arg   value="">
          <constructor-arg   ref="">
     b. setter 메서드 이용
        <bean>
	  <property value="">
          <property ref="">

      - 주입받은 대상
          기본형, 문자열 : value 속성
	  클래스(참조형) : ref 속성
##################################################################
https://docs.spring.io/spring-framework/docs/5.2.25.RELEASE/spring-framework-reference/core.html#beans-collection-elements
1. 1:n 의존성 주입 ==> Collection

  가. list
     - ArrayList
     - 순서있고 중복 가능
  나. set
     - HashSet
     - 순서없고 중복 불가
  다. map
     - HashMap
     - key/value 저장
     - key와 value 모두 object

  라. props
     - Properties
     - key/value 저장
     - key와 value 모두 String

2. util 태그 이용 - Collection
https://docs.spring.io/spring-framework/docs/5.2.25.RELEASE/spring-framework-reference/core.html#appendix
   반드시 util namespace 설정
    가. list
      <util:list id="xxx">
		<ref bean="cat1" />
		<ref bean="cat2" />
		<ref bean="cat1" />
	</util:list>

    <bean id="service" class="com.service.UserService">
      <property name="list" >
        <ref bean="xxx"/>
      </property>
    </bean>

    나. set
     <!-- util -->
	<util:set id="xxx">
		<ref bean="cat1" />
		<ref bean="cat2" />
		<ref bean="cat1" />
	</util:set>
	<bean id="service" class="com.service.UserService">
		<property name="set">
		  <ref bean="xxx" />
		</property>
	</bean>

    다. map
    <util:map id="xxx">
		<entry key="c1" value-ref="cat1" />
		<entry key="c2">
			<ref bean="cat2" />
		</entry>
	</util:map>

	<bean id="service" class="com.service.UserService">
		<property name="map">
			<ref bean="xxx"/>
		</property>
	</bean>

    라.props



3. 빈 생성 관련되는 콜백 메서드

   가. 서블릿 
      - init() 메서드
      - doGet()/doPost() 메서드
      - destory() 메서드

   나. Spring
      a. <bean id="" class=""  init-method="메서드명" destroy-method="메서드명" >
      b. interface 이용

         - implments InitializingBean, DisposalBean{
	       // 추상메서드 재정의
	   }
      c. 어노테이션 이용
         - JDK 11 지원 불가 ( JDK 8 지원됨 )

         - @PostConstruct
	  pulic void xxx(){}
	 - @PreDestroy
	  pulic void yyy(){}

4. profile
  - profile값에 따라서 개발환경을 다양하게 구축 가능.

  - 구성
   가. 개발환경
       - user-dev.xml
       - UserServiceDev.java

   나. 배포환경
       - user-prod.xml
       - UserServiceProd.java


               UserService (인터페이스)
	           |
    UserServiceDev    UserServiceProd

    
    설정방법:
    	GenericXmlApplicationContext ctx = 
				new GenericXmlApplicationContext();
		
	//profile 설정
	ctx.getEnvironment().setActiveProfiles("prod");  //dev, prod
	ctx.load("classpath:user-dev.xml", "classpath:user-prod.xml");
	ctx.refresh();


5. jdbc.properties에 설정된 환경설정값을 빈에 주입해서 사용하기

   가. src/main/resource에 jdbc.properties 작성

   나. xml에 jdbc.properties 파일 등록
      <!-- jdbc.properties 등록 -->
      <context:property-placeholder location="classpath:com/config/jdbc.properties"/>
     
   다. 빈에 주입
      - ${key}


6. I18N ( 국제화: InternationalizatioN )
  https://docs.spring.io/spring-framework/docs/5.2.25.RELEASE/spring-framework-reference/core.html#context-functionality-messagesource
    가. 리소스번들 파일 작성
      문법: 파일명_국가별언어코드.properties
      src/main/resource에 저장
      greeting_ko.properties
      greeting_en.properties


    나. 리소스번들 등록 ( 주의할 점은 id값은 반드시 messageSource 로 설정해야 된다. )
   <bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
     <property name="basename" value="classpath:com/config/greeting" />
     <!--  properties 파일 인코딩을 utf-8로 지정한 경우 -->
     <property name="defaultEncoding" value="utf-8" />
   </bean>

   
    다. 사용

      a. TestMain에서 사용 가능
         	 MessageSource resources = 
				 new ClassPathXmlApplicationContext("classpath:com/config/user.xml");
		 String message = resources.getMessage("greet", new String[]{"홍길동","!!!"}, "Default", Locale.KOREA);
		 System.out.println(message);

      b. TestMain가 아닌 임의의 빈에서 사용 가능
         public class UserService implements MessageSourceAware{
	
	MessageSource resources;

	@Override
	public void setMessageSource(MessageSource messageSource) {
		this.resources = messageSource;
	}
      c. jsp에서 사용 가능






